# HTML5 runtime
# 
# Copyright (C) 2015 Zhang Ji Peng
# Contact: onecoolx@gmail.com

{
# icuuc
  'variables': {
    'lib_dir': 'icu_55',
    'lib_name': 'icuuc',
  },
  'target_name': '<(lib_name)',
  'type': 'shared_library',
  'dependencies': [
  ],
  'defines': [
    'U_COMMON_IMPLEMENTATION',
  ],
  'include_dirs': [
    '<(lib_dir)/source/common',
  ],
  'sources': [ 
    '<(lib_dir)/source/common/appendable.cpp',
    '<(lib_dir)/source/common/bmpset.cpp',
    '<(lib_dir)/source/common/brkeng.cpp',
    '<(lib_dir)/source/common/brkiter.cpp',
    '<(lib_dir)/source/common/bytestream.cpp',
    '<(lib_dir)/source/common/bytestriebuilder.cpp',
    '<(lib_dir)/source/common/bytestrie.cpp',
    '<(lib_dir)/source/common/bytestrieiterator.cpp',
    '<(lib_dir)/source/common/caniter.cpp',
    '<(lib_dir)/source/common/chariter.cpp',
    '<(lib_dir)/source/common/charstr.cpp',
    '<(lib_dir)/source/common/dictbe.cpp',
    '<(lib_dir)/source/common/dictionarydata.cpp',
    '<(lib_dir)/source/common/dtintrv.cpp',
    '<(lib_dir)/source/common/errorcode.cpp',
    '<(lib_dir)/source/common/filterednormalizer2.cpp',
    '<(lib_dir)/source/common/icuplug.cpp',
    '<(lib_dir)/source/common/listformatter.cpp',
    '<(lib_dir)/source/common/loadednormalizer2impl.cpp',
    '<(lib_dir)/source/common/locavailable.cpp',
    '<(lib_dir)/source/common/locbased.cpp',
    '<(lib_dir)/source/common/locdispnames.cpp',
    '<(lib_dir)/source/common/locid.cpp',
    '<(lib_dir)/source/common/loclikely.cpp',
    '<(lib_dir)/source/common/locresdata.cpp',
    '<(lib_dir)/source/common/locutil.cpp',
    '<(lib_dir)/source/common/messagepattern.cpp',
    '<(lib_dir)/source/common/normalizer2.cpp',
    '<(lib_dir)/source/common/normalizer2impl.cpp',
    '<(lib_dir)/source/common/normlzr.cpp',
    '<(lib_dir)/source/common/parsepos.cpp',
    '<(lib_dir)/source/common/patternprops.cpp',
    '<(lib_dir)/source/common/propname.cpp',
    '<(lib_dir)/source/common/punycode.cpp',
    '<(lib_dir)/source/common/putil.cpp',
    '<(lib_dir)/source/common/rbbi.cpp',
    '<(lib_dir)/source/common/rbbidata.cpp',
    '<(lib_dir)/source/common/rbbinode.cpp',
    '<(lib_dir)/source/common/rbbirb.cpp',
    '<(lib_dir)/source/common/rbbiscan.cpp',
    '<(lib_dir)/source/common/rbbisetb.cpp',
    '<(lib_dir)/source/common/rbbistbl.cpp',
    '<(lib_dir)/source/common/rbbitblb.cpp',
    '<(lib_dir)/source/common/resbund_cnv.cpp',
    '<(lib_dir)/source/common/resbund.cpp',
    '<(lib_dir)/source/common/ruleiter.cpp',
    '<(lib_dir)/source/common/schriter.cpp',
    '<(lib_dir)/source/common/serv.cpp',
    '<(lib_dir)/source/common/servlk.cpp',
    '<(lib_dir)/source/common/servlkf.cpp',
    '<(lib_dir)/source/common/servls.cpp',
    '<(lib_dir)/source/common/servnotf.cpp',
    '<(lib_dir)/source/common/servrbf.cpp',
    '<(lib_dir)/source/common/servslkf.cpp',
    '<(lib_dir)/source/common/sharedobject.cpp',
    '<(lib_dir)/source/common/simplepatternformatter.cpp',
    '<(lib_dir)/source/common/stringpiece.cpp',
    '<(lib_dir)/source/common/stringtriebuilder.cpp',
    '<(lib_dir)/source/common/ubrk.cpp',
    '<(lib_dir)/source/common/ucase.cpp',
    '<(lib_dir)/source/common/ucasemap.cpp',
    '<(lib_dir)/source/common/ucasemap_titlecase_brkiter.cpp',
    '<(lib_dir)/source/common/ucharstriebuilder.cpp',
    '<(lib_dir)/source/common/ucharstrie.cpp',
    '<(lib_dir)/source/common/ucharstrieiterator.cpp',
    '<(lib_dir)/source/common/uchriter.cpp',
    '<(lib_dir)/source/common/ucln_cmn.cpp',
    '<(lib_dir)/source/common/ucnv2022.cpp',
    '<(lib_dir)/source/common/ucnv_bld.cpp',
    '<(lib_dir)/source/common/ucnvbocu.cpp',
    '<(lib_dir)/source/common/ucnv_ext.cpp',
    '<(lib_dir)/source/common/ucnv_io.cpp',
    '<(lib_dir)/source/common/ucnvmbcs.cpp',
    '<(lib_dir)/source/common/ucnvsel.cpp',
    '<(lib_dir)/source/common/ucol_swp.cpp',
    '<(lib_dir)/source/common/udata.cpp',
    '<(lib_dir)/source/common/uhash_us.cpp',
    '<(lib_dir)/source/common/uidna.cpp',
    '<(lib_dir)/source/common/uinit.cpp',
    '<(lib_dir)/source/common/uiter.cpp',
    '<(lib_dir)/source/common/ulistformatter.cpp',
    '<(lib_dir)/source/common/uloc.cpp',
    '<(lib_dir)/source/common/uloc_keytype.cpp',
    '<(lib_dir)/source/common/umutex.cpp',
    '<(lib_dir)/source/common/unames.cpp',
    '<(lib_dir)/source/common/unifiedcache.cpp',
    '<(lib_dir)/source/common/unifilt.cpp',
    '<(lib_dir)/source/common/unifunct.cpp',
    '<(lib_dir)/source/common/uniset_closure.cpp',
    '<(lib_dir)/source/common/uniset.cpp',
    '<(lib_dir)/source/common/uniset_props.cpp',
    '<(lib_dir)/source/common/unisetspan.cpp',
    '<(lib_dir)/source/common/unistr_case.cpp',
    '<(lib_dir)/source/common/unistr_case_locale.cpp',
    '<(lib_dir)/source/common/unistr_cnv.cpp',
    '<(lib_dir)/source/common/unistr.cpp',
    '<(lib_dir)/source/common/unistr_props.cpp',
    '<(lib_dir)/source/common/unistr_titlecase_brkiter.cpp',
    '<(lib_dir)/source/common/unormcmp.cpp',
    '<(lib_dir)/source/common/unorm.cpp',
    '<(lib_dir)/source/common/uobject.cpp',
    '<(lib_dir)/source/common/uprops.cpp',
    '<(lib_dir)/source/common/uresbund.cpp',
    '<(lib_dir)/source/common/uscript_props.cpp',
    '<(lib_dir)/source/common/uset.cpp',
    '<(lib_dir)/source/common/usetiter.cpp',
    '<(lib_dir)/source/common/uset_props.cpp',
    '<(lib_dir)/source/common/ushape.cpp',
    '<(lib_dir)/source/common/usprep.cpp',
    '<(lib_dir)/source/common/ustack.cpp',
    '<(lib_dir)/source/common/ustrcase.cpp',
    '<(lib_dir)/source/common/ustrcase_locale.cpp',
    '<(lib_dir)/source/common/ustr_cnv.cpp',
    '<(lib_dir)/source/common/ustrenum.cpp',
    '<(lib_dir)/source/common/ustring.cpp',
    '<(lib_dir)/source/common/ustr_titlecase_brkiter.cpp',
    '<(lib_dir)/source/common/ustrtrns.cpp',
    '<(lib_dir)/source/common/ustr_wcs.cpp',
    '<(lib_dir)/source/common/utext.cpp',
    '<(lib_dir)/source/common/util.cpp',
    '<(lib_dir)/source/common/util_props.cpp',
    '<(lib_dir)/source/common/utrie2_builder.cpp',
    '<(lib_dir)/source/common/utrie2.cpp',
    '<(lib_dir)/source/common/utrie.cpp',
    '<(lib_dir)/source/common/uts46.cpp',
    '<(lib_dir)/source/common/uvector.cpp',
    '<(lib_dir)/source/common/uvectr32.cpp',
    '<(lib_dir)/source/common/uvectr64.cpp',
    '<(lib_dir)/source/common/cmemory.c',
    '<(lib_dir)/source/common/cstring.c',
    '<(lib_dir)/source/common/cwchar.c',
    '<(lib_dir)/source/common/icudataver.c',
    '<(lib_dir)/source/common/locmap.c',
    '<(lib_dir)/source/common/propsvec.c',
    '<(lib_dir)/source/common/uarrsort.c',
    '<(lib_dir)/source/common/ubidi.c',
    '<(lib_dir)/source/common/ubidiln.c',
    '<(lib_dir)/source/common/ubidi_props.c',
    '<(lib_dir)/source/common/ubidiwrt.c',
    '<(lib_dir)/source/common/ucat.c',
    '<(lib_dir)/source/common/uchar.c',
    '<(lib_dir)/source/common/ucmndata.c',
    '<(lib_dir)/source/common/ucnv.c',
    '<(lib_dir)/source/common/ucnv_cb.c',
    '<(lib_dir)/source/common/ucnv_cnv.c',
    '<(lib_dir)/source/common/ucnv_ct.c',
    '<(lib_dir)/source/common/ucnvdisp.c',
    '<(lib_dir)/source/common/ucnv_err.c',
    '<(lib_dir)/source/common/ucnvhz.c',
    '<(lib_dir)/source/common/ucnvisci.c',
    '<(lib_dir)/source/common/ucnvlat1.c',
    '<(lib_dir)/source/common/ucnv_lmb.c',
    '<(lib_dir)/source/common/ucnvscsu.c',
    '<(lib_dir)/source/common/ucnv_set.c',
    '<(lib_dir)/source/common/ucnv_u16.c',
    '<(lib_dir)/source/common/ucnv_u32.c',
    '<(lib_dir)/source/common/ucnv_u7.c',
    '<(lib_dir)/source/common/ucnv_u8.c',
    '<(lib_dir)/source/common/udatamem.c',
    '<(lib_dir)/source/common/udataswp.c',
    '<(lib_dir)/source/common/uenum.c',
    '<(lib_dir)/source/common/uhash.c',
    '<(lib_dir)/source/common/uinvchar.c',
    '<(lib_dir)/source/common/ulist.c',
    '<(lib_dir)/source/common/uloc_tag.c',
    '<(lib_dir)/source/common/umapfile.c',
    '<(lib_dir)/source/common/umath.c',
    '<(lib_dir)/source/common/ures_cnv.c',
    '<(lib_dir)/source/common/uresdata.c',
    '<(lib_dir)/source/common/usc_impl.c',
    '<(lib_dir)/source/common/uscript.c',
    '<(lib_dir)/source/common/ustrfmt.c',
    '<(lib_dir)/source/common/utf_impl.c',
    '<(lib_dir)/source/common/utrace.c',
    '<(lib_dir)/source/common/utypes.c',
    '<(lib_dir)/source/common/wintz.c',
  ],
  'conditions': [
    ['OS=="win"', {
      'include_dirs': [
        '$(OutDir)/include',
      ],
      'defines': [
        'U_ATTRIBUTE_DEPRECATED=',
      ],
      'sources': [ 
        '<(lib_dir)/source/common/common.rc',
      ],
      'libraries': [
        '$(OutDir)/lib/icudt.lib',
      ],
      'actions': [
       {
        'action_name': 'install_headers',
        'inputs': [
          '<(lib_dir)/source/common/unicode', 
         ],
        'outputs': [
          '$(OutDir)/include/uc/unicode',
         ],
        'action': [
          'python',
          'tools/cp.py',
          '<(_inputs)',
          '$(OutDir)/include/uc/unicode',
        ],
        'msvs_cygwin_shell': 0,
       },
       {
        'action_name': 'install_dll',
        'inputs': [
          '<(lib_dir)/win32/icudt55.dll', 
         ],
        'outputs': [
          '$(OutDir)/icudt55.dll',
         ],
        'action': [
          'python',
          'tools/cp.py',
          '<(_inputs)',
          '$(OutDir)/icudt55.dll',
        ],
        'msvs_cygwin_shell': 0,
       },
       {
        'action_name': 'install_libs',
        'inputs': [
          '<(lib_dir)/win32/icudt.lib', 
         ],
        'outputs': [
          '$(OutDir)/lib/icudt.lib',
         ],
        'action': [
          'python',
          'tools/cp.py',
          '<(_inputs)',
          '$(OutDir)/lib/icudt.lib',
        ],
        'msvs_cygwin_shell': 0,
       }],
       'msvs_disabled_warnings': [4251, 4244, 4996, 4595],
    }],
    ['OS=="linux"', {
      'include_dirs': [
        '$(builddir)/include',
      ],
      'defines': [
        'U_ATTRIBUTE_DEPRECATED=',
      ],
      'sources': [ 
        '<(lib_dir)/linux/icudtl_dat.S',
      ],
      'cflags': [
        '-fstrict-aliasing',
        '-fvisibility=hidden',
      ],
      'cflags_cc': [
        '-fvisibility-inlines-hidden',
      ],
      'libraries': [
        '-lpthread',
        '-ldl',
      ],
      'actions': [
      {
       'action_name': 'install_headers',
       'inputs': [
         '<(lib_dir)/source/common/unicode', 
       ],
       'outputs': [
         '$(builddir)/include/uc/unicode', 
       ],
       'action': [
       'python',
       'tools/cp.py',
       '<(_inputs)',
       '$(builddir)/include/uc/unicode',
       ],
      }],
    }],
  ],
  'includes': [
    '../build/configs.gypi',
    '../build/defines.gypi',
  ],
}
